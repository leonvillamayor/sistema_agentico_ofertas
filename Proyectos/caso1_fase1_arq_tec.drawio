<mxfile host="app.diagrams.net">
  <diagram name="SSMAS Yield Predictivo - Fase I - Arquitectura Técnica" id="caso1-fase1-technical">
    <mxGraphModel dx="1422" dy="821" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Título -->
        <mxCell id="title" value="SSMAS Yield Predictivo - Fase I: PoC y MVP - Arquitectura Técnica Detallada" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="200" y="10" width="769" height="30" as="geometry" />
        </mxCell>

        <!-- Development VPC -->
        <mxCell id="dev-vpc" value="Development VPC (10.2.0.0/16) - eu-west-1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=14;fontStyle=1;fillColor=#E1F5FE;strokeColor=#0288D1;strokeWidth=3;" vertex="1" parent="1">
          <mxGeometry x="50" y="50" width="1070" height="740" as="geometry" />
        </mxCell>

        <!-- Availability Zone A -->
        <mxCell id="az-a" value="Availability Zone A (eu-west-1a)" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=12;fontStyle=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;" vertex="1" parent="1">
          <mxGeometry x="80" y="90" width="300" height="680" as="geometry" />
        </mxCell>

        <!-- Availability Zone B -->
        <mxCell id="az-b" value="Availability Zone B (eu-west-1b)" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=12;fontStyle=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;" vertex="1" parent="1">
          <mxGeometry x="400" y="90" width="300" height="680" as="geometry" />
        </mxCell>

        <!-- Services Zone -->
        <mxCell id="services-zone" value="Servicios Gestionados AWS" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=12;fontStyle=1;fillColor=#E8F5E8;strokeColor=#4CAF50;" vertex="1" parent="1">
          <mxGeometry x="720" y="90" width="380" height="680" as="geometry" />
        </mxCell>

        <!-- Public Subnets -->
        <mxCell id="public-subnet-a" value="Public Subnet A&#xa;10.2.1.0/24" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=10;fillColor=#FFF3E0;strokeColor=#F57C00;" vertex="1" parent="1">
          <mxGeometry x="100" y="120" width="260" height="100" as="geometry" />
        </mxCell>

        <mxCell id="public-subnet-b" value="Public Subnet B&#xa;10.2.2.0/24" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=10;fillColor=#FFF3E0;strokeColor=#F57C00;" vertex="1" parent="1">
          <mxGeometry x="420" y="120" width="260" height="100" as="geometry" />
        </mxCell>

        <!-- NAT Gateways -->
        <mxCell id="nat-gw-a" value="NAT Gateway A&#xa;10.2.1.10" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFECB3;strokeColor=#FF8F00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="120" y="150" width="80" height="40" as="geometry" />
        </mxCell>

        <mxCell id="nat-gw-b" value="NAT Gateway B&#xa;10.2.2.10" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFECB3;strokeColor=#FF8F00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="440" y="150" width="80" height="40" as="geometry" />
        </mxCell>

        <!-- Internet Gateway -->
        <mxCell id="igw" value="Internet Gateway&#xa;igw-ssmas-poc" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="60" width="120" height="40" as="geometry" />
        </mxCell>

        <!-- Private Subnets -->
        <mxCell id="private-subnet-a" value="Private Subnet A&#xa;10.2.10.0/24" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=10;fillColor=#E8F5E8;strokeColor=#4CAF50;" vertex="1" parent="1">
          <mxGeometry x="100" y="240" width="260" height="510" as="geometry" />
        </mxCell>

        <mxCell id="private-subnet-b" value="Private Subnet B&#xa;10.2.11.0/24" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=10;fillColor=#E8F5E8;strokeColor=#4CAF50;" vertex="1" parent="1">
          <mxGeometry x="420" y="240" width="260" height="510" as="geometry" />
        </mxCell>

        <!-- Glue ETL Jobs in Private Subnets -->
        <mxCell id="glue-job-a" value="AWS Glue Job&#xa;Feature Engineering&#xa;10.2.10.50" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#4CAF50;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="120" y="270" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="glue-crawler-a" value="AWS Glue Crawler&#xa;Schema Discovery&#xa;10.2.10.51" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#4CAF50;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="240" y="270" width="100" height="50" as="geometry" />
        </mxCell>

        <!-- VPC Endpoints -->
        <mxCell id="s3-endpoint" value="S3 VPC Endpoint&#xa;Gateway Type" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#D32F2F;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="120" y="340" width="100" height="40" as="geometry" />
        </mxCell>

        <mxCell id="sagemaker-endpoint-vpc" value="SageMaker&#xa;VPC Endpoint" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#D32F2F;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="240" y="340" width="100" height="40" as="geometry" />
        </mxCell>

        <!-- Lambda Functions -->
        <mxCell id="lambda-integration" value="Lambda Function&#xa;API Integration&#xa;512MB RAM&#xa;30s timeout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#F57C00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="440" y="270" width="120" height="60" as="geometry" />
        </mxCell>

        <mxCell id="lambda-preprocessing" value="Lambda Function&#xa;Data Preprocessing&#xa;1GB RAM&#xa;15min timeout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#F57C00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="440" y="350" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- CloudWatch Logs Groups -->
        <mxCell id="logs-sagemaker" value="CloudWatch Logs&#xa;/aws/sagemaker/&#xa;yield-predictor" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8BBD9;strokeColor=#C2185B;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="120" y="600" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="logs-glue" value="CloudWatch Logs&#xa;/aws/glue/&#xa;feature-engineering" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8BBD9;strokeColor=#C2185B;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="240" y="600" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="logs-lambda" value="CloudWatch Logs&#xa;/aws/lambda/&#xa;api-integration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8BBD9;strokeColor=#C2185B;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="440" y="600" width="120" height="50" as="geometry" />
        </mxCell>

        <!-- Security Groups -->
        <mxCell id="sg-sagemaker" value="SG: sagemaker-dev&#xa;443 → 0.0.0.0/0&#xa;22 → VPC CIDR" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEBEE;strokeColor=#D32F2F;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="120" y="680" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="sg-glue" value="SG: glue-dev&#xa;443 → 0.0.0.0/0&#xa;All → VPC CIDR" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEBEE;strokeColor=#D32F2F;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="240" y="680" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="sg-lambda" value="SG: lambda-dev&#xa;443 → 0.0.0.0/0&#xa;All → VPC CIDR" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEBEE;strokeColor=#D32F2F;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="440" y="680" width="120" height="50" as="geometry" />
        </mxCell>

        <!-- S3 Buckets -->
        <mxCell id="s3-main" value="S3 Bucket&#xa;ssmas-yield-poc-dev-eu-west-1&#xa;&#xa;Encryption: KMS&#xa;Versioning: Enabled&#xa;Lifecycle: 90d → IA" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#E1F5FE;strokeColor=#0288D1;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="750" y="130" width="140" height="100" as="geometry" />
        </mxCell>

        <mxCell id="s3-structure" value="Estructura S3:&#xa;/raw-data/impressions/&#xa;/raw-data/users/&#xa;/processed/features/&#xa;/processed/training/&#xa;/models/artifacts/&#xa;/outputs/predictions/" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F1F8E9;strokeColor=#689F38;fontSize=8;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="910" y="130" width="170" height="100" as="geometry" />
        </mxCell>

        <!-- SageMaker Services -->
        <mxCell id="sagemaker-notebook" value="SageMaker Notebook&#xa;ml.t3.medium&#xa;20GB EBS&#xa;Jupyter Lab" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE0B2;strokeColor=#F57C00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="750" y="250" width="120" height="60" as="geometry" />
        </mxCell>

        <mxCell id="sagemaker-training" value="SageMaker Training&#xa;ml.m5.xlarge&#xa;XGBoost 1.3-1&#xa;Max Runtime: 3600s" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE0B2;strokeColor=#F57C00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="890" y="250" width="120" height="60" as="geometry" />
        </mxCell>

        <mxCell id="sagemaker-endpoint" value="SageMaker Endpoint&#xa;ml.t2.medium&#xa;Min: 1, Max: 3&#xa;Auto Scaling" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE0B2;strokeColor=#F57C00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="750" y="330" width="120" height="60" as="geometry" />
        </mxCell>

        <mxCell id="sagemaker-model" value="SageMaker Model&#xa;yield-predictor-v1&#xa;Container: XGBoost&#xa;Inference Script" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE0B2;strokeColor=#F57C00;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="890" y="330" width="120" height="60" as="geometry" />
        </mxCell>

        <!-- API Gateway -->
        <mxCell id="api-gateway-detail" value="API Gateway REST&#xa;ssmas-yield-api-poc&#xa;&#xa;Endpoints:&#xa;POST /predict&#xa;GET /health&#xa;&#xa;Throttling: 1000/sec&#xa;Caching: 5min TTL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#4CAF50;fontSize=9;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="750" y="420" width="140" height="100" as="geometry" />
        </mxCell>

        <!-- CloudWatch -->
        <mxCell id="cloudwatch-metrics" value="CloudWatch Metrics&#xa;&#xa;Custom Namespace:&#xa;SSMAS/YieldPredictor&#xa;&#xa;Metrics:&#xa;• ModelRMSE&#xa;• ModelMAE&#xa;• PredictionLatency&#xa;• ThroughputTPS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8BBD9;strokeColor=#C2185B;fontSize=9;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="750" y="540" width="140" height="100" as="geometry" />
        </mxCell>

        <mxCell id="cloudwatch-dashboard" value="CloudWatch Dashboard&#xa;ssmas-yield-poc&#xa;&#xa;Widgets:&#xa;• Model Performance&#xa;• Endpoint Metrics&#xa;• API Gateway Stats&#xa;• Cost Tracking&#xa;• Error Rates" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8BBD9;strokeColor=#C2185B;fontSize=9;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="910" y="540" width="140" height="100" as="geometry" />
        </mxCell>

        <!-- KMS Keys -->
        <mxCell id="kms-key" value="KMS Key&#xa;alias/ssmas-yield-poc&#xa;&#xa;Usage:&#xa;• S3 Encryption&#xa;• SageMaker Models&#xa;• CloudWatch Logs&#xa;• Parameter Store" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#D32F2F;fontSize=9;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="910" y="420" width="140" height="100" as="geometry" />
        </mxCell>

        <!-- IAM Roles Detail -->
        <mxCell id="iam-roles-detail" value="IAM Roles&#xa;&#xa;SageMakerExecutionRole-poc:&#xa;• S3 ReadWrite&#xa;• CloudWatch Logs&#xa;• SageMaker Full&#xa;&#xa;GlueServiceRole-poc:&#xa;• S3 ReadWrite&#xa;• Glue Full&#xa;&#xa;LambdaExecutionRole-poc:&#xa;• SageMaker Invoke&#xa;• Logs Write" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#D32F2F;fontSize=8;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="750" y="660" width="320" height="100" as="geometry" />
        </mxCell>

        <!-- Data Processing Flow -->
        <mxCell id="processing-flow" value="Flujo de Procesamiento ML:&#xa;&#xa;1. Raw Data → S3 (Elastic API)&#xa;2. Glue ETL → Feature Engineering&#xa;3. Processed Data → S3&#xa;4. SageMaker Training → Model&#xa;5. Model → Endpoint&#xa;6. API Gateway → Lambda → Endpoint&#xa;7. Prediction Response" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#F57C00;fontSize=9;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="120" y="450" width="220" height="120" as="geometry" />
        </mxCell>

        <!-- Network Flow Arrows -->
        <mxCell id="flow1" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#2196F3;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="igw" target="public-subnet-a">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="100" as="sourcePoint" />
            <mxPoint x="230" y="120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="380" y="110" />
              <mxPoint x="230" y="110" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow2" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#2196F3;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="igw" target="public-subnet-b">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="100" as="sourcePoint" />
            <mxPoint x="550" y="120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="380" y="110" />
              <mxPoint x="550" y="110" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow3" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#4CAF50;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="nat-gw-a" target="private-subnet-a">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="160" y="190" as="sourcePoint" />
            <mxPoint x="230" y="240" as="targetPoint" />
            <Array as="points">
              <mxPoint x="160" y="220" />
              <mxPoint x="230" y="220" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow4" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#4CAF50;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="nat-gw-b" target="private-subnet-b">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="480" y="190" as="sourcePoint" />
            <mxPoint x="550" y="240" as="targetPoint" />
            <Array as="points">
              <mxPoint x="480" y="220" />
              <mxPoint x="550" y="220" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow5" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#FF9800;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="lambda-integration" target="api-gateway-detail">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="560" y="300" as="sourcePoint" />
            <mxPoint x="750" y="470" as="targetPoint" />
            <Array as="points">
              <mxPoint x="650" y="300" />
              <mxPoint x="650" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Cost Estimation Box -->
        <mxCell id="cost-estimation" value="Estimación de Costos/Mes:&#xa;&#xa;S3 (100GB): $6.30&#xa;SageMaker: $50.96&#xa;Glue: $9.80&#xa;API Gateway: $3.50&#xa;Lambda: $1.87&#xa;CloudWatch: $20.00&#xa;&#xa;Total: ~$92/mes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFDE7;strokeColor=#F9A825;fontSize=10;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="440" y="450" width="140" height="130" as="geometry" />
        </mxCell>

        <!-- Performance Metrics -->
        <mxCell id="performance-target" value="Objetivos de Performance:&#xa;&#xa;• RMSE &lt; 0.50 EUR&#xa;• MAE &lt; 0.30 EUR&#xa;• R² &gt; 0.75&#xa;• Latencia P95 &lt; 50ms&#xa;• Throughput &gt; 1K/seg&#xa;• Uptime &gt; 99.5%" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E0F2F1;strokeColor=#00695C;fontSize=10;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="120" y="390" width="220" height="120" as="geometry" />
        </mxCell>

        <!-- Data Labels -->
        <mxCell id="data-label1" value="1GB/día" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="360" y="180" width="40" height="15" as="geometry" />
        </mxCell>

        <mxCell id="data-label2" value="50ms avg" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="610" y="360" width="50" height="15" as="geometry" />
        </mxCell>

        <mxCell id="data-label3" value="1K req/s" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="610" y="450" width="50" height="15" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>